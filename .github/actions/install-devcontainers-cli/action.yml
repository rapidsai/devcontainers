name: install-devcontainers-cli

description: Install devcontainers CLI

runs:
  using: composite
  steps:
    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '20'
    - name: Install devcontainers CLI
      shell: bash
      run: |
        sudo apt update;
        sudo apt install -y --no-install-recommends build-essential;
        npm install -g @devcontainers/cli@v0.76.0;
        # HACK: remove the `-t` arg from the `docker buildx build` command generated by `devcontainer build`
        sed -i 's/,t.map(v=>l.push("-t",v))//g' "$(npm list -g | head -1)"/node_modules/@devcontainers/cli/dist/spec-node/devContainersSpecCLI.js
